

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Welcome to pyneqsys’s documentation! &mdash; pyneqsys 0.5.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="pyneqsys 0.5.2 documentation" href="#"/>
        <link rel="next" title="pyneqsys package" href="pyneqsys.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="#" class="icon icon-home"> pyneqsys
          

          
          </a>

          
            
            
              <div class="version">
                0.5.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyneqsys.html">pyneqsys package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">pyneqsys</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Welcome to pyneqsys’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-pyneqsys-s-documentation">
<h1>Welcome to pyneqsys’s documentation!<a class="headerlink" href="#welcome-to-pyneqsys-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyneqsys.html">pyneqsys package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyneqsys.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyneqsys.html#module-pyneqsys.core">pyneqsys.core module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyneqsys.html#module-pyneqsys.plotting">pyneqsys.plotting module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyneqsys.html#module-pyneqsys.solvers">pyneqsys.solvers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyneqsys.html#module-pyneqsys.symbolic">pyneqsys.symbolic module</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
<div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="http://hera.physchem.kth.se:9090/bjodah/pyneqsys"><img alt="Build status" src="http://hera.physchem.kth.se:9090/api/badges/bjodah/pyneqsys/status.svg" /></a>
<a class="reference external image-reference" href="https://circleci.com/gh/bjodah/pyneqsys"><img alt="Build status on CircleCI" src="https://circleci.com/gh/bjodah/pyneqsys.svg?style=svg" /></a>
<a class="reference external image-reference" href="http://travis-ci.org/bjodah/pyneqsys"><img alt="Build status on Travis-CI" src="https://secure.travis-ci.org/bjodah/pyneqsys.svg?branch=master" /></a>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/pyneqsys"><img alt="PyPI version" src="https://img.shields.io/pypi/v/pyneqsys.svg" /></a>
<a class="reference external image-reference" href="https://www.python.org/"><img alt="Python version" src="https://img.shields.io/badge/python-2.7,3.5,3.6-blue.svg" /></a>
<a class="reference external image-reference" href="https://github.com/bjodah/pyneqsys/blob/master/LICENSE"><img alt="License file" src="https://img.shields.io/pypi/l/pyneqsys.svg" /></a>
<a class="reference external image-reference" href="http://hera.physchem.kth.se/~pyneqsys/branches/master/htmlcov"><img alt="coverage" src="http://hera.physchem.kth.se/~pyneqsys/branches/master/htmlcov/coverage.svg" /></a>
<p>pyneqsys provides a convenience class for
representing and solving non-linear equation systems from symbolic expressions
(provided e.g. with the help of <a class="reference external" href="http://www.sympy.org">SymPy</a>).</p>
<p>The numerical root finding is perfomed using either:</p>
<ul class="simple">
<li>scipy: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html">scipy.optimize.root</a></li>
<li>mpmath (arbitrary precision): <a class="reference external" href="http://mpmath.org/doc/1.0.0/calculus/optimization.html#mpmath.calculus.optimization.MDNewton">mpmath.calculus.optimization.MDNewton</a></li>
<li>kinsol (from SUNDIALS): <a class="reference external" href="http://bjodah.github.io/pykinsol/latest/pykinsol.html#pykinsol.solve">pykinsol.solve</a></li>
<li>nleq2 (ZIB library free for academic use): <a class="reference external" href="http://bjodah.github.io/pynleq2/pynleq2.html#pynleq2.solve">pynleq2.solve</a></li>
<li>levmar (Levenberg-Marquardt): <a class="reference external" href="https://bjodah.github.io/levmar/latest/levmar.html#levmar.levmar">levmar.levmar</a></li>
</ul>
<p>In addition to offering a unified interface to different solvers, pyneqsys
can also derive the Jacobian analytically (when using <code class="docutils literal"><span class="pre">pyneqsys.SymbolicSys</span></code>).
This is useful since doing so manually is widely recognized as both tedious and error
prone.</p>
<p>The symbolic representation is usually in the form of <a class="reference external" href="http://www.sympy.org">SymPy</a> expressions,
but the user may choose another symbolic back-end (see <a class="reference external" href="https://github.com/bjodah/sym">sym</a>).</p>
<p>In addition to deriving the Jacobian analytically the symbolic representation can for
example apply row-reduce. This is usful for when you have a overdetermined system (
formed from e.g. applying conservation laws) and want to solve the system by
root-finding rather than using a least-square optimization of e.g. Levenberg-Marquardt
style.</p>
<p>Last, but not the least having a symbolic representation of your system of equations
allows you to generate publication quality latex representations of your equations (through
SymPy’s latex printer) from a <strong>single</strong> source‒no more error prone hand-rewriting of the same
equations in another format for presentation!</p>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>Autogenerated API documentation for latest stable release is found here:
<a class="reference external" href="https://bjodah.github.io/pyneqsys/latest">https://bjodah.github.io/pyneqsys/latest</a>
(and the development version for the current master branch is found here:
<a class="reference external" href="http://hera.physchem.kth.se/~pyneqsys/branches/master/html">http://hera.physchem.kth.se/~pyneqsys/branches/master/html</a>).</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Simplest way to install pyneqsys and its dependencies is through the <a class="reference external" href="http://conda.pydata.org/docs/">conda package manager</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ conda install -c bjodah pyneqsys pytest
$ pytest --pyargs pyneqsys
</pre></div>
</div>
<div class="section" id="optional-dependencies">
<h3>Optional dependencies<a class="headerlink" href="#optional-dependencies" title="Permalink to this headline">¶</a></h3>
<p>If you used <code class="docutils literal"><span class="pre">conda</span></code> to install <a href="#id2"><span class="problematic" id="id3">pyneqsys_</span></a> you can skip this section.
But if you use <code class="docutils literal"><span class="pre">pip</span></code> you may want to know that the default installation
of <code class="docutils literal"><span class="pre">pyneqsys</span></code> only requires SciPy:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ pip install pyneqsys
$ pytest --pyargs pyneqsys -rs
</pre></div>
</div>
<p>The above command should finish without errors but with some skipped tests.
The reason for why some tests are skipped should be because missing optional solvers.
To install the optional solvers you will first need to install third party libraries for
the solvers and then their python bindings. The 3rd party requirements are as follows:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/bjodah/pykinsol">pykinsol</a> (requires <a class="reference external" href="https://computation.llnl.gov/projects/sundials">SUNDIALS</a> ==2.7.0)</li>
<li><a class="reference external" href="https://github.com/bjodah/levmar">levar</a></li>
<li><a class="reference external" href="http://www.mpmath.org">mpmath</a></li>
</ul>
<p>if you want to see what packages need to be installed on a Debian based system you may look at this
<a class="reference external" href="scripts/environment/Dockerfile">Dockerfile</a>.</p>
<p>If you manage to install all three external libraries you may install pyneqsys with the option “all”:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ pip install pyneqsys[all]
$ pytest --pyargs pyneqsys -rs
</pre></div>
</div>
<p>now there should be no skipped tests. If you try to install pyneqsys on a machine where you do not have
root permissions you may find the flag <code class="docutils literal"><span class="pre">--user</span></code> helpful when using pip. Also if there are multiple
versions of python installed you may want to invoke python for an explicit version of python, e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python3.6 -m pip install --user pyneqsys[all]
</pre></div>
</div>
<p>see <a class="reference external" href="setup.py">setup.py</a> for the exact list of requirements.</p>
</div>
<div class="section" id="using-docker">
<h3>Using Docker<a class="headerlink" href="#using-docker" title="Permalink to this headline">¶</a></h3>
<p>If you have <a class="reference external" href="https://www.docker.com">Docker</a> installed, you may use it to host a jupyter
notebook server:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ ./scripts/host-jupyter-using-docker.sh . 8888
</pre></div>
</div>
<p>the first time you run the command some dependencies will be downloaded. When the installation
is complete there will be a link visible which you can open in your browser. You can also run
the test suite using the same docker-image:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ ./scripts/host-jupyter-using-docker.sh . 0
</pre></div>
</div>
<p>there will be one skipped test (due to symengine missing in this pip installed environment) and
quite a few instances of RintimeWarning.</p>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Example reformulated from <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html">SciPy documentation</a>:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyneqsys.symbolic</span> <span class="k">import</span> <span class="n">SymbolicSys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neqsys</span> <span class="o">=</span> <span class="n">SymbolicSys</span><span class="o">.</span><span class="n">from_callback</span><span class="p">(</span>
<span class="gp">... </span>    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>               <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">neqsys</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[ 0.8411639  0.1588361]</span>
</pre></div>
</div>
<p>here we did not need to enter the jacobian manually, SymPy did that for us.
For expressions containing transcendental functions we need to provide a
“backend” keyword arguemnt to enable symbolic derivation of the jacobian:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">powell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">math</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">A</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">backend</span><span class="o">.</span><span class="n">exp</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">A</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">A</span><span class="o">**-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powell_sys</span> <span class="o">=</span> <span class="n">SymbolicSys</span><span class="o">.</span><span class="n">from_callback</span><span class="p">(</span><span class="n">powell</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;x0 x1&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">powell_sys</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1000.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%.6e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">)]))</span>
<span class="go">1.477106e-04, 6.769996e+00</span>
</pre></div>
</div>
<p>pyneqsys also allows the user to solve a system of equations for a span of
values for a parameter, and optionally plot the result vs. the varied value:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">all_x</span><span class="p">,</span> <span class="n">all_info</span> <span class="o">=</span> <span class="n">powell_sys</span><span class="o">.</span><span class="n">solve_and_plot_series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mf">1000.0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e3</span><span class="p">,</span> <span class="mf">3e3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>  
</pre></div>
</div>
<img alt="https://raw.githubusercontent.com/bjodah/pyneqsys/master/examples/example.png" src="https://raw.githubusercontent.com/bjodah/pyneqsys/master/examples/example.png" />
<p>For more examples look see
<a class="reference external" href="https://github.com/bjodah/pyneqsys/tree/master/examples">examples/</a>, and rendered jupyter notebooks here:
<a class="reference external" href="http://hera.physchem.kth.se/~pyneqsys/branches/master/examples">http://hera.physchem.kth.se/~pyneqsys/branches/master/examples</a></p>
<div class="section" id="run-notebooks-using-binder">
<h3>Run notebooks using binder<a class="headerlink" href="#run-notebooks-using-binder" title="Permalink to this headline">¶</a></h3>
<p>Using only a web-browser (and an internet connection) it is possible to explore the
notebooks here: (by the courtesy of the people behind mybinder)</p>
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/bjodah/pyneqsys/d8775becc6f30b4d3e7920f53d5f318c0672195b?filepath=index.ipynb"><img alt="Binder" src="http://mybinder.org/badge.svg" /></a>
</div>
</div>
<div class="section" id="licensing">
<h2>Licensing<a class="headerlink" href="#licensing" title="Permalink to this headline">¶</a></h2>
<p>The source code is Open Source and is released under the simplified 2-clause BSD license. See <a class="reference external" href="LICENSE">LICENSE</a> for further details.</p>
</div>
<div class="section" id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>Contributors are welcome to suggest improvements at <a class="reference external" href="https://github.com/bjodah/pyneqsys">https://github.com/bjodah/pyneqsys</a>
(see further details <a class="reference external" href="CONTRIBUTING.rst">here</a>).</p>
</div>
<div class="section" id="author">
<h2>Author<a class="headerlink" href="#author" title="Permalink to this headline">¶</a></h2>
<p>Björn I. Dahlgren, contact:</p>
<ul class="simple">
<li>gmail address: bjodah</li>
<li>kth.se address: bda</li>
</ul>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pyneqsys.html" class="btn btn-neutral float-right" title="pyneqsys package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Bjoern I. Dahlgren &lt;bjodah@gmail.com&gt;.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.5.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>